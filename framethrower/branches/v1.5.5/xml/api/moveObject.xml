<f:transaction
	xmlns:f="http://www.filmsfolded.com/xsl/ui"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

	<f:param name="object" />
	<f:param name="destination" />

	<f:derived name="oldParent" from="object">
		<f:get what="parentSituation" />
	</f:derived>

	<xsl:template>
		<f:transaction>
					
			
			<f:intact with-id="{$object/@id}" prop="parentSituation" action="set">
				<f:with-param value-id="{$destination/@id}" />
			</f:intact>
			

			<f:intact with-id="{$oldParent/@id}" prop="childObjects" action="remove">
				<f:with-param value-id="{$object/@id}" />
			</f:intact>

			<f:intact with-id="{$destination/@id}" prop="childObjects" action="add">
				<f:with-param value-id="{$object/@id}" />
			</f:intact>
			
			<!-->
				TODO: add code for adjusting the corresponds chain
				UPDATE: shouldn't have to add code here now
			</!-->
			
		</f:transaction>
	</xsl:template>
</f:transaction>
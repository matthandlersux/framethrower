<f:binding
	xmlns:f="http://www.filmsfolded.com/xsl/ui"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
	
	<f:transaction name="Open" event="click">
		<f:param name="zui" />
		<f:param name="focus" />
		<f:derived name="type" from="focus">
			<f:gettype />
		</f:derived>
		
		<xsl:template>
			<f:transaction>
				<f:make type="layout.zui" name="newZui" />
				<f:intact with-var="newZui" prop="focus" action="set">
					<f:with-param><xsl:copy-of select="$focus" /></f:with-param>
				</f:intact>
				<f:intact with-var="newZui" prop="properties" action="set">
					<f:with-param>
						<xsl:choose>
							<xsl:when test="$type/@value = 'kernel.situation'">
								<zui view="situation" childrenSidebar="1" correspondSidebar="0"/>
							</xsl:when>
							<xsl:otherwise>
								<zui view="object" correspondSidebar="0"/>
							</xsl:otherwise>
						</xsl:choose>
					</f:with-param>
				</f:intact>
				<f:intact with-var="newZui" prop="parentZui" action="set">
					<f:with-param value-id="{$zui/@id}" />
				</f:intact>
				
				<f:intact with-var="newZui" prop="minimized" action="set">
					<f:with-param>
						<f:bool value="false" />
					</f:with-param>
				</f:intact>
				<f:intact with-var="newZui" prop="leftChildInView" action="set">
					<f:with-param>
						<f:number value="0" />
					</f:with-param>
				</f:intact>
				<f:intact with-var="newZui" prop="leftRailChild" action="set">
					<f:with-param>
						<f:number value="0" />
					</f:with-param>
				</f:intact>
				
				
				<f:intact with-id="{$zui/@id}" prop="childZuis" action="append">
					<f:with-param value-var="newZui" />
				</f:intact>
				
				<f:perform url="taskbar.xml#Center">
					<f:with-param name="zui" value-var="newZui" />
				</f:perform>
				
				<f:return as="newZui" value-var="newZui" />
			</f:transaction>
		</xsl:template>
	</f:transaction>
	
</f:binding>
<f:binding
	xmlns:f="http://www.filmsfolded.com/xsl/ui"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
	
	<f:transaction name="Open" event="click">
		<f:param name="zui" />
		<f:param name="focus" />
		<f:derived name="type" from="focus">
			<gettype />
		</f:derived>
		
		<xsl:template>
			<transaction>
				<make type="layout.zui" name="newZui" />
				<intact with-var="newZui" prop="focus" action="set">
					<with-param><xsl:copy-of select="$focus" /></with-param>
				</intact>
				<intact with-var="newZui" prop="properties" action="set">
					<with-param>
						<xsl:choose>
							<xsl:when test="$type/@value = 'kernel.situation'">
								<zui view="situation" childrenSidebar="1" correspondSidebar="0"/>
							</xsl:when>
							<xsl:otherwise>
								<zui view="object" correspondSidebar="0"/>
							</xsl:otherwise>
						</xsl:choose>
					</with-param>
				</intact>
				<intact with-var="newZui" prop="parentZui" action="set">
					<with-param value-id="{$zui/@id}" />
				</intact>
				
				<intact with-var="newZui" prop="minimized" action="set">
					<with-param>
						<f:bool value="false" />
					</with-param>
				</intact>
				
				<intact with-id="{$zui/@id}" prop="childZuis" action="add">
					<with-param value-var="newZui" />
				</intact>
				
				<f:return as="newZui" value-var="newZui" />
			</transaction>
		</xsl:template>
	</f:transaction>
</f:binding>
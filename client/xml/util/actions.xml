<f:includes
	xmlns:f="http://www.worldmerge.com/2008/xsl"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
	xmlns:html="http://www.w3.org/1999/xhtml"
	xmlns:svg="http://www.w3.org/2000/svg">

	<f:action name="makeNamedObject">
		<f:param name="name" type="String" />
		<f:param name="type" type="Object" />
			
		<f:create type="Object" name="object" />

		<f:perform with-action="$nameObject">
			<f:with-param name="object" select="$object" />
			<f:with-param name="name" select="$name" />
		</f:perform>
		<f:perform with-action="$typeObject">
			<f:with-param name="object" select="$object" />
			<f:with-param name="type" select="$type" />
		</f:perform>
	
		<f:return name="object" />
	</f:action>

	<f:action name="nameObject">
		<f:param name="object" type="Object" />
		<f:param name="name" type="String" />
	
		<f:derive name="nameRel" d="shared.name" />
	
		<f:create type="X.text" name="nameText">
			<f:with-param name="string" select="$name" />
		</f:create>
	
		<f:perform with-action="$makeOntProperty">
			<f:with-param name="relation" select="$nameRel" />
			<f:with-param name="arg1" select="$object" />
			<f:with-param name="arg2" select="$nameText" />
		</f:perform>
	</f:action>
	
	<f:action name="thumbnailObject">
		<f:param name="object" type="Object" />
		<f:param name="url" type="String" />
		<f:param name="width" type="Number" />
		<f:param name="height" type="Number" />
	
		<f:derive name="thumbnailRel" d="shared.thumbnail" />
	
		<f:create type="X.picture" name="pic">
			<f:with-param name="url" select="$url" />
			<f:with-param name="width" select="$width" />
			<f:with-param name="height" select="$height" />
		</f:create>
	
		<f:perform with-action="$makeOntProperty">
			<f:with-param name="relation" select="$thumbnailRel" />
			<f:with-param name="arg1" select="$object" />
			<f:with-param name="arg2" select="$pic" />
		</f:perform>
	</f:action>

	<f:action name="relationTemplateObject">
		<f:param name="object" type="Object" />
		<f:param name="relTem" type="XML" />
	
		<f:derive name="relTemRel" d="shared.relationTemplate" />
	
		<f:create type="X.xml" name="xml">
			<f:with-param name="xml" select="$relTem" />
		</f:create>
	
		<f:perform with-action="$makeOntProperty">
			<f:with-param name="relation" select="$relTemRel" />
			<f:with-param name="arg1" select="$object" />
			<f:with-param name="arg2" select="$xml" />
		</f:perform>
	</f:action>



	<f:action name="typeObject">
		<f:param name="object" type="Object" />
		<f:param name="type" type="Object" />
	
		<f:derive name="isA" d="shared.isA" />
	
		<f:perform with-action="$makeOntProperty">
			<f:with-param name="relation" select="$isA" />
			<f:with-param name="arg1" select="$object" />
			<f:with-param name="arg2" select="$type" />
		</f:perform>
	</f:action>
	
	<f:action name="makeType">
		<f:param name="object" type="Object" />
		
		<f:derive name="isType" d="shared.isType" />
		
		<f:perform with-action="$makeInfon1" name="infon">
			<f:with-param name="relation" select="$isType" />
			<f:with-param name="arg1" select="$object" />
		</f:perform>
		<f:perform with-action="$makeTrueInOnt">
			<f:with-param name="infon" select="$infon" />
		</f:perform>
	</f:action>



	<f:action name="makeOntProperty">
		<f:param name="relation" type="Object" />
		<f:param name="arg1" type="Object" />
		<f:param name="arg2" type="Object" />
	
		<f:perform with-action="$makeInfon2" name="infon">
			<f:with-param name="relation" select="$relation" />
			<f:with-param name="arg1" select="$arg1" />
			<f:with-param name="arg2" select="$arg2" />
		</f:perform>
	
		<f:perform with-action="$makeTrueInOnt">
			<f:with-param name="infon" select="$infon" />
		</f:perform>
	</f:action>



	<f:action name="makeTrueInOnt">
		<f:param name="infon" type="Cons" />
		<f:derive name="ont" d="shared.ont" />
	
		<f:perform with-action="$putObjectInSituation">
			<f:with-param name="object" select="$infon" />
			<f:with-param name="situation" select="$ont" />
		</f:perform>
	</f:action>




	<f:action name="putObjectInSituation">
		<f:param name="object" type="Object" />
		<f:param name="situation" type="Object" />
		<f:derive name="in" d="shared.in" />
	
		<f:perform with-action="$makeInfon2" name="infon">
			<f:with-param name="relation" select="$in" />
			<f:with-param name="arg1" select="$situation" />
			<f:with-param name="arg2" select="$object" />
		</f:perform>
		<f:intact object="$infon" property="truth" action="add" key="null" />
	</f:action>



	<f:action name="makeInfon3">
		<f:param name="relation" type="Object" />
		<f:param name="arg1" type="Object" />
		<f:param name="arg2" type="Object" />
		<f:param name="arg3" type="Object" />		
	
		<f:perform with-action="$makeCons" name="cons1">
			<f:with-param name="left" select="$relation" />
			<f:with-param name="right" select="$arg1" />
		</f:perform>

		<f:perform with-action="$makeCons" name="cons2">
			<f:with-param name="left" select="$cons1" />
			<f:with-param name="right" select="$arg2" />
		</f:perform>
		
		<f:perform with-action="$makeCons" name="cons3">
			<f:with-param name="left" select="$cons2" />
			<f:with-param name="right" select="$arg3" />
		</f:perform>
	
		<f:return name="cons3" />
	</f:action>

	<f:action name="makeInfon2">
		<f:param name="relation" type="Object" />
		<f:param name="arg1" type="Object" />
		<f:param name="arg2" type="Object" />		
	
		<f:perform with-action="$makeCons" name="cons1">
			<f:with-param name="left" select="$relation" />
			<f:with-param name="right" select="$arg1" />
		</f:perform>

		<f:perform with-action="$makeCons" name="cons2">
			<f:with-param name="left" select="$cons1" />
			<f:with-param name="right" select="$arg2" />
		</f:perform>
	
		<f:return name="cons2" />
	</f:action>
	
	<f:action name="makeInfon1">
		<f:param name="relation" type="Object" />
		<f:param name="arg1" type="Object" />
		
		<f:perform with-action="$makeCons" name="cons1">
			<f:with-param name="left" select="$relation" />
			<f:with-param name="right" select="$arg1" />
		</f:perform>
		
		<f:return name="cons1" />
	</f:action>

	<f:action name="makeCons">
		<f:param name="left" type="Object" />
		<f:param name="right" type="Object" />
	
		<f:create type="Cons" name="cons">
			<f:with-param name="left" select="$left" />
			<f:with-param name="right" select="$right" />
		</f:create>
	
		<f:intact object="$left" property="upRight" action="add" key="$cons" />
		<f:intact object="$right" property="upLeft" action="add" key="$cons" />
	
		<f:return name="cons" />
	</f:action>
	
	
	<f:action name="makeRelationType4">
		<f:param name="input1" type="Object" />
		<f:param name="input2" type="Object" />
		<f:param name="input3" type="Object" />
		<f:param name="input4" type="Object" />		
		<f:param name="output" type="Object" />
		
		<f:perform with-action="$makeRelationType" name="rt1">
			<f:with-param name="input" select="$input4" />
			<f:with-param name="output" select="$output" />
		</f:perform>
		<f:perform with-action="$makeRelationType" name="rt2">
			<f:with-param name="input" select="$input3" />
			<f:with-param name="output" select="$rt1" />
		</f:perform>
		<f:perform with-action="$makeRelationType" name="rt3">
			<f:with-param name="input" select="$input2" />
			<f:with-param name="output" select="$rt2" />
		</f:perform>
		<f:perform with-action="$makeRelationType" name="rt4">
			<f:with-param name="input" select="$input1" />
			<f:with-param name="output" select="$rt3" />
		</f:perform>		
		<f:return name="rt4" />
	</f:action>

	
	<f:action name="makeRelationType3">
		<f:param name="input1" type="Object" />
		<f:param name="input2" type="Object" />
		<f:param name="input3" type="Object" />
		<f:param name="output" type="Object" />
		
		<f:perform with-action="$makeRelationType" name="rt1">
			<f:with-param name="input" select="$input3" />
			<f:with-param name="output" select="$output" />
		</f:perform>
		<f:perform with-action="$makeRelationType" name="rt2">
			<f:with-param name="input" select="$input2" />
			<f:with-param name="output" select="$rt1" />
		</f:perform>
		<f:perform with-action="$makeRelationType" name="rt3">
			<f:with-param name="input" select="$input1" />
			<f:with-param name="output" select="$rt2" />
		</f:perform>
		<f:return name="rt3" />
	</f:action>	
	
	<f:action name="makeRelationType2">
		<f:param name="input1" type="Object" />
		<f:param name="input2" type="Object" />
		<f:param name="output" type="Object" />
		
		<f:perform with-action="$makeRelationType" name="rt1">
			<f:with-param name="input" select="$input2" />
			<f:with-param name="output" select="$output" />
		</f:perform>
		<f:perform with-action="$makeRelationType" name="rt2">
			<f:with-param name="input" select="$input1" />
			<f:with-param name="output" select="$rt1" />
		</f:perform>
		<f:return name="rt2" />
	</f:action>
	
	<f:action name="makeRelationType">
		<f:param name="input" type="Object" />
		<f:param name="output" type="Object" />
		<f:derive name="relationType" d="shared.type.relation" />
	
		<f:perform with-action="$makeInfon2" name="infon">
			<f:with-param name="relation" select="$relationType" />
			<f:with-param name="arg1" select="$input" />
			<f:with-param name="arg2" select="$output" />
		</f:perform>
		
		<f:return name="infon" />
	</f:action>

</f:includes>
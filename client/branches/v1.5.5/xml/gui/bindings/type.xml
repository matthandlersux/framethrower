<f:binding
	xmlns:f="http://www.filmsfolded.com/xsl/ui"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
	
	<f:transaction name="Expand Collapse" event="click">
		<f:param name="zui" />
		<f:param name="type" />
		<f:derived name="expandedTypes" from="zui">
			<f:get what="expandedTypes" />
		</f:derived>
		
		<xsl:template>
			<f:transaction>
				<xsl:variable name="typeId" select="$type/@id" />
				<xsl:choose>
					<xsl:when test="$expandedTypes/*[@id = $typeId]">
						<f:intact with-id="{$zui/@id}" prop="expandedTypes" action="remove">
							<f:with-param><xsl:copy-of select="$type" /></f:with-param>
						</f:intact>
					</xsl:when>
					<xsl:otherwise>
						<f:intact with-id="{$zui/@id}" prop="expandedTypes" action="add">
							<f:with-param><xsl:copy-of select="$type" /></f:with-param>
						</f:intact>
					</xsl:otherwise>
				</xsl:choose>
			</f:transaction>
		</xsl:template>
	</f:transaction>
</f:binding>
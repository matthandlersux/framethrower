<html>
<head>
	<title>Movie Chooser</title>

<script>
function loadMovie() {
	var moviePath = document.getElementById("moviePath").value;
	var url = "file://" + escape(moviePath);
	
	var mov = makeQTMovie(url, 640, 480);
	
	mov.addEventListener("qt_loadedmetadata", function () {
		var rect = mov.GetRectangle();
		var split = rect.split(",");
		
		var aspect = (split[2] - split[0]) / (split[3] - split[1]);
		var duration = mov.GetDuration() / mov.GetTimeScale();
		
		document.cookie = encodeURIComponent(url) + "!" + encodeURIComponent(aspect) + "!" + encodeURIComponent(duration);
		
		document.getElementById("success").innerHTML="Movie Loaded Successfully<br />Aspect Ratio: "+aspect+" &nbsp; Duration: "+duration+" seconds";
	}, false);
	
	var area = document.getElementById("movieArea");
	
	area.appendChild(mov);
}

function makeQTMovie(src, width, height) {
	//var mov = document.createElementNS(xmlns["html"], "embed");
	var mov = document.createElement("embed");
	
	function setAtt(name, value) {
		mov.setAttributeNS("", name, value);
	}
	setAtt("width", width);
	setAtt("height", height);
	setAtt("enablejavascript", "true");
	setAtt("postdomevents", "true");
	setAtt("scale", "aspect");
	setAtt("controller", "false");
	setAtt("autoplay", "false");
	
	setAtt("src", "dummy.mov");
	setAtt("qtsrc", src);
	setAtt("qtsrcdontusebrowser", "true");
	
	//setAtt("src", src);
	
	return mov;
}
</script>

</head>
<body>

<p>
	Choose the movie file: <input type="file" size="80" />
</p>

<p>
	Copy and paste the local path (above) here: <input size="80" id="moviePath" />
</p>

<p>
	<input type="button" value="Load Movie" onclick="loadMovie()" />
</p>


<div id="success" style="font-size: 24px; font-weight:bold; height: 100px;"></div>

<div id="movieArea"></div>

</body>
</html>